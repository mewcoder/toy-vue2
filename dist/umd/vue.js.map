{"version":3,"file":"vue.js","sources":["../../src/observer/array.js","../../src/util/index.js","../../src/observer/dep.js","../../src/observer/index.js","../../src/util/next-tick.js","../../src/observer/scheduler.js","../../src/observer/watcher.js","../../src/instance/state.js","../../src/vdom/patch.js","../../src/instance/lifecycle.js","../../src/compiler/generate.js","../../src/compiler/parser.js","../../src/compiler/index.js","../../src/util/options.js","../../src/instance/init.js","../../src/vdom/index.js","../../src/instance/render.js","../../src/global-api/index.js","../../src/instance/index.js"],"sourcesContent":["const arrayProto = Array.prototype;\r\n\r\nexport const arrayMethods = Object.create(Array.prototype);\r\n\r\nconst methodsToPatch = [\r\n  \"push\",\r\n  \"shift\",\r\n  \"unshift\",\r\n  \"pop\",\r\n  \"reverse\",\r\n  \"sort\",\r\n  \"splice\",\r\n];\r\n\r\nmethodsToPatch.forEach((method) => {\r\n  arrayMethods[method] = function (...args) {\r\n    const result = arrayProto[method].apply(this, args);\r\n    const ob = this.__ob__;\r\n    let inserted;\r\n    switch (method) {\r\n      case \"push\":\r\n      case \"unshift\":\r\n        inserted = args;\r\n        break;\r\n      case \"splice\":\r\n        inserted = args.slice(2);\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    if (inserted) ob.observeArray(inserted); // 对新增的每一项进行观测\r\n\r\n    // 数组的dep 属性\r\n    ob.dep.notify();\r\n\r\n    return result;\r\n  };\r\n});\r\n","export function isObject(val) {\r\n  return val !== null && typeof val === \"object\";\r\n}\r\n","let id = 0;\r\n// 每个属性对应一个dep\r\nclass Dep {\r\n  constructor() {\r\n    this.id = id++;\r\n    this.subs = [];\r\n  }\r\n\r\n  depend() {\r\n    if (Dep.target) {\r\n      Dep.target.addDep(this); // 让watch收集的dep\r\n    }\r\n  }\r\n\r\n  notify() {\r\n    this.subs.forEach((sub) => sub.update());\r\n  }\r\n\r\n  addSub(sub) {\r\n    this.subs.push(sub);\r\n  }\r\n}\r\n\r\nconst stack = [];\r\n\r\nexport function pushTarget(watcher) {\r\n  Dep.target = watcher;\r\n  stack.push(watcher);\r\n}\r\n\r\nexport function popTarget() {\r\n  stack.pop();\r\n  Dep.target = stack[stack.length - 1];\r\n}\r\nexport default Dep;\r\n","import { arrayMethods } from \"./array\";\r\nimport { isObject } from \"../util/index\";\r\nimport Dep from \"./dep\";\r\n/**\r\n * Observer class that is attached to each observed object(__ob__).\r\n * Once attached, the observer converts the target object's property keys\r\n * into getter/setters(defineProperty) that collect dependencies and dispatch updates.\r\n *\r\n *  1.如果数据是对象 会将对象不停的递归 进行劫持\r\n *  2.如果是数组，会劫持数组的方法，并对数组中不是基本数据类型的进行检测\r\n */\r\n\r\nclass Observer {\r\n  constructor(value) {\r\n    this.value = value;\r\n\r\n    this.dep = new Dep(); // 数据如果是数组，需要在Observer实例上加dep\r\n\r\n    // 被劫持过的属性都有__ob__（Observer实例）\r\n    Object.defineProperty(value, \"__ob__\", {\r\n      value: this,\r\n      enumerable: false, // 不可枚举\r\n    });\r\n    if (Array.isArray(value)) {\r\n      value.__proto__ = arrayMethods; // 劫持数组原型方法\r\n      this.observeArray(value);\r\n    } else {\r\n      this.walk(value);\r\n    }\r\n  }\r\n\r\n  // 遍历所有属性并将它们转换为 getter/setter\r\n  walk(obj) {\r\n    const keys = Object.keys(obj);\r\n    for (let i = 0; i < keys.length; i++) {\r\n      defineReactive(obj, keys[i], obj[keys[i]]);\r\n    }\r\n  }\r\n\r\n  observeArray(data) {\r\n    for (let i = 0; i < data.length; i++) {\r\n      observe(data[i]);\r\n    }\r\n  }\r\n}\r\n\r\nfunction defineReactive(obj, key, val) {\r\n  const childOb = observe(val); //递归\r\n  const dep = new Dep();\r\n  Object.defineProperty(obj, key, {\r\n    enumerable: true,\r\n    configurable: true,\r\n    get: function reactiveGetter() {\r\n      if (Dep.target) {\r\n        dep.depend(); // 让 dep 记住 watcher\r\n        if (childOb) {\r\n          // 可能是数组可能是对象，对象也要收集依赖，后续写 $set方法时需要触发他自己的更新操作\r\n          childOb.dep.depend(); // 就是让数组和对象也记录 watcher\r\n          if (Array.isArray(val)) {\r\n            //取外层数组要将数组里面的也进行依赖收集\r\n            dependArray(val);\r\n          }\r\n        }\r\n      }\r\n      return val;\r\n    },\r\n    set: function reactiveSetter(newVal) {\r\n      observe(newVal);\r\n      if (newVal === val) return;\r\n      val = newVal;\r\n      dep.notify();\r\n    },\r\n  });\r\n}\r\n\r\nfunction dependArray(value) {\r\n  for (let i = 0; i < value.length; i++) {\r\n    const current = value[i];\r\n    current.__ob__ && current.__ob__.dep.depend();\r\n    if (Array.isArray(current)) {\r\n      dependArray(current);\r\n    }\r\n  }\r\n}\r\n\r\nexport function observe(value) {\r\n  if (!isObject(value)) return;\r\n  if (value.__ob__) {\r\n    return value.__ob__;\r\n  }\r\n  return new Observer(value); // 返回Observer实例\r\n}\r\n","const callbacks = [];\r\n\r\nfunction flushCallbacks() {\r\n  callbacks.forEach(cb => cb());\r\n  waiting = false\r\n}\r\nlet waiting = false;\r\nfunction timer(flushCallbacks) {\r\n  let timerFn = () => { }\r\n  if (Promise) {\r\n    timerFn = () => {\r\n      Promise.resolve().then(flushCallbacks)\r\n    }\r\n  } else if (MutationObserver) {\r\n    let textNode = document.createTextNode(1);\r\n    let observe = new MutationObserver(flushCallbacks);\r\n    observe.observe(textNode, {\r\n      characterData: true\r\n    })\r\n    timerFn = () => {\r\n      textNode.textContent = 3;\r\n    }\r\n    // 微任务\r\n  } else if (setImmediate) {\r\n    timerFn = () => {\r\n      setImmediate(flushCallbacks)\r\n    }\r\n  } else {\r\n    timerFn = () => {\r\n      setTimeout(flushCallbacks)\r\n    }\r\n  }\r\n  timerFn();\r\n}\r\n\r\n// 微任务是在页面渲染前执行 我取的是内存中的dom，不关心你渲染完毕没有\r\n\r\nexport function nextTick(cb) {\r\n  callbacks.push(cb); // flushSchedulerQueue / userCallback\r\n\r\n  if (!waiting) {\r\n    timer(flushCallbacks); // vue2 中考虑了兼容性问题 vue3 里面不在考虑兼容性问题\r\n    waiting = true;\r\n  }\r\n}","import { nextTick } from \"../util/next-tick\";\n\nlet queue = [];\nlet has = {}; // 做列表的 列表维护存放了哪些watcher\n\n// 动画  滚动的频率高，节流 requestFrameAnimation\nfunction flushSchedulerQueue() {\n  for (let i = 0; i < queue.length; i++) {\n    queue[i].run(); // vm.name = 123?\n  }\n  queue = [];\n  has = {};\n  pending = false;\n}\n\nlet pending = false;\n\n// 要等待同步代码执行完毕后 才执行异步逻辑\nexport function queueWatcher(watcher) { // 当前执行栈中代码执行完毕后，会先清空微任务，在清空宏任务， 我希望尽早更新页面\n  const id = watcher.id; // name 和 age的id 是同一个\n  if (has[id] == null) {\n    queue.push(watcher);\n    has[id] = true;\n    // 开启一次更新操作  批处理 （防抖）\n    if (!pending) {\n      nextTick(flushSchedulerQueue, 0);\n      pending = true;\n    }\n  }\n}","import { popTarget, pushTarget } from \"./dep\";\r\nimport { queueWatcher } from \"./scheduler\";\r\n\r\nlet id = 0\r\n\r\nclass Watcher {\r\n  constructor(vm, expOrFn, cb, options) {\r\n    this.deps = [];\r\n    this.depIds = new Set();\r\n    this.vm = vm;\r\n    this.expOrFn = expOrFn;\r\n    this.user = !!options.user;\r\n    this.lazy = !!options.lazy;\r\n    this.dirty = options.lazy; // 如果是计算属性，那么默认值lazy:true, dirty:true\r\n    if (typeof expOrFn === 'string') {\r\n      // 需要将表达式转化成函数\r\n      this.getter = function () {\r\n        const path = expOrFn.split('.');\r\n        let obj = vm;\r\n        for (let i = 0; i < path.length; i++) {\r\n          obj = obj[path[i]];\r\n        }\r\n        return obj;\r\n      }\r\n    } else {\r\n      this.getter = expOrFn;\r\n    }\r\n    this.cb = cb;\r\n    this.options = options;\r\n    this.id = ++id;\r\n    // 第一次的value\r\n    this.value = this.lazy ? undefined : this.get(); // 默认初始化 要取值\r\n  }\r\n  // 更新时可重新调用该方法\r\n  get() {\r\n    // 一个属性可以对应多个watcher\r\n    // 一个watcher可以对应多个属性 \r\n    pushTarget(this);\r\n    const value = this.getter.call(this.vm);\r\n    popTarget();\r\n    return value;\r\n  }\r\n\r\n  evaluate() {\r\n    this.dirty = false; // 为false表示取过值了\r\n    this.value = this.get(); // 用户的getter执行\r\n  }\r\n\r\n  depend() {\r\n    let i = this.deps.length;\r\n    while (i--) {\r\n      this.deps[i].depend(); //lastName,firstName 收集渲染watcher\r\n    }\r\n  }\r\n\r\n  addDep(dep) {\r\n    let id = dep.id;\r\n    if (!this.depIds.has(id)) {\r\n      this.depIds.add(id);  //去重，一个组件中可用到多个相同的属性,让watcher记住dep\r\n      this.deps.push(dep);\r\n      dep.addSub(this); // 让dep存入watcher\r\n    }\r\n  }\r\n\r\n  update() {\r\n    if (this.lazy) {\r\n      this.dirty = true;\r\n    } else {\r\n      queueWatcher(this); // 多次调用update 我希望先将watcher缓存下来，等一会一起更新\r\n    }\r\n  }\r\n\r\n  run() {\r\n    const newVal = this.get();\r\n    const oldVal = this.value;\r\n    this.value = newVal;\r\n\r\n    if (this.user) {\r\n      this.cb.call(this.vm, newVal, oldVal);\r\n    }\r\n  }\r\n\r\n}\r\n\r\n\r\nexport default Watcher;","import {\r\n  observe,\r\n} from '../observer/index'\r\n\r\nimport Watcher from '../observer/watcher'\r\n\r\n\r\nexport function stateMixin(Vue) {\r\n  Vue.prototype.$watch = function (key, handler, options = {}) {\r\n    options.user = true; // 是一个用户自己写的watcher\r\n    // vm,name,用户回调，options.user\r\n    new Watcher(this, key, handler, options);\r\n  }\r\n}\r\n\r\n\r\nexport function initState(vm) {\r\n  const opts = vm.$options\r\n  if (opts.data) initData(vm)\r\n  if (opts.watch) initWatch(vm)\r\n  if (opts.props) initProps(vm)\r\n  if (opts.methods) initMethods(vm)\r\n  if (opts.computed) initComputed(vm)\r\n}\r\n\r\n\r\n// 初始化数据\r\nfunction initData(vm) {\r\n  let data = vm.$options.data;\r\n  // 可能是函数\r\n  data = vm._data = typeof data === 'function'\r\n    ? getData(data, vm)\r\n    : data || {}\r\n\r\n\r\n  // 把 data里的数据 代理到vm上\r\n  const keys = Object.keys(data)\r\n  let i = keys.length;\r\n  while (i--) {\r\n    proxy(vm, \"_data\", keys[i]);\r\n  }\r\n\r\n  observe(data); // 观察数据\r\n}\r\n\r\nexport function proxy(target, sourceKey, key) {\r\n  Object.defineProperty(target, key, {\r\n    get() {\r\n      return target[sourceKey][key];\r\n    },\r\n    set(newVal) {\r\n      target[sourceKey][key] = newVal;\r\n    },\r\n  });\r\n}\r\n\r\n\r\n\r\nfunction initWatch(vm) { // Object.keys\r\n  const watch = vm.$options.watch;\r\n  for (let key in watch) {\r\n    let handler = watch[key];\r\n\r\n    if (Array.isArray(handler)) {\r\n      for (let i = 0; i < handler.length; i++) {\r\n        createWatcher(vm, key, handler[i])\r\n      }\r\n    } else {\r\n      createWatcher(vm, key, handler)\r\n    }\r\n\r\n  }\r\n}\r\n\r\nfunction createWatcher(vm, key, handler) {\r\n  return vm.$watch(key, handler)\r\n}\r\n\r\nfunction initComputed(vm) {\r\n  const computed = vm.$options.computed;\r\n\r\n  const watchers = vm._computedWatchers = {}\r\n  for (let key in computed) {\r\n    // 校验 \r\n    const userDef = computed[key];\r\n    // 依赖的属性变化就重新取值 get\r\n    const getter = typeof userDef == 'function' ? userDef : userDef.get;\r\n\r\n    // 每个计算属性本质就是watcher   \r\n    // 将watcher和 属性 做一个映射\r\n    watchers[key] = new Watcher(vm, getter, () => { }, { lazy: true }); // 默认不执行\r\n\r\n    // 将key 定义在vm上\r\n    defineComputed(vm, key, userDef);\r\n  }\r\n}\r\n\r\n\r\nfunction defineComputed(vm, key, userDef) {\r\n  let sharedProperty = {};\r\n  if (typeof userDef == 'function') {\r\n    sharedProperty.get = userDef;\r\n  } else {\r\n    sharedProperty.get = createComputedGetter(key);\r\n    sharedProperty.set = userDef.set;\r\n  }\r\n  Object.defineProperty(vm, key, sharedProperty); // computed就是一个defineProperty\r\n}\r\n\r\n\r\nfunction createComputedGetter(key) {\r\n\r\n  return function  () { // 取计算属性的值 走的是这个函数\r\n    // this._computedWatchers 包含着所有的计算属性\r\n\r\n    // 通过key 可以拿到对应watcher，这个watcher中包含了getter\r\n    let watcher = this._computedWatchers[key]\r\n    // 脏就是 要调用用户的getter  不脏就是不要调用getter\r\n\r\n    if (watcher.dirty) { // 根据dirty属性 来判断是否需要重新求职\r\n      watcher.evaluate();// this.get()\r\n    }\r\n\r\n    // 如果当前取完值后 Dep.target还有值  需要继续向上收集\r\n    if (Dep.target) {\r\n      // 计算属性watcher 内部 有两个dep  firstName,lastName\r\n      watcher.depend(); // watcher 里 对应了 多个dep\r\n    }\r\n    return watcher.value\r\n  }\r\n}","export function patch(oldVnode, vnode) {\r\n  if (oldVnode.nodeType == 1) {\r\n    // 用vnode  来生成真实dom 替换原本的dom元素\r\n    const parentElm = oldVnode.parentNode; // 找到他的父亲\r\n    let elm = createElm(vnode); //根据虚拟节点 创建元素\r\n    parentElm.insertBefore(elm, oldVnode.nextSibling);\r\n\r\n    parentElm.removeChild(oldVnode);\r\n\r\n    return elm;\r\n  }\r\n}\r\n\r\nfunction createElm(vnode) {\r\n  let { tag, data, children, text, vm } = vnode;\r\n  if (typeof tag === \"string\") {\r\n    // 元素\r\n    vnode.el = document.createElement(tag); // 虚拟节点会有一个el属性 对应真实节点\r\n    children.forEach((child) => {\r\n      vnode.el.appendChild(createElm(child));\r\n    });\r\n  } else {\r\n    vnode.el = document.createTextNode(text);\r\n  }\r\n  return vnode.el;\r\n}\r\n","\r\nimport { patch } from \"../vdom/patch\";\r\nimport Watcher from \"../observer/watcher\";\r\n\r\nexport function lifecycleMixin(Vue) {\r\n  // 用虚拟dom 生成真实dom\r\n  Vue.prototype._update = function (vnode) {\r\n    // 既有初始化 又有更新\r\n    const vm = this;\r\n    vm.$el = patch(vm.$el, vnode); // 将返回的真实dom挂载到vm.$el上\r\n  };\r\n\r\n}\r\n\r\nexport function mountComponent(vm, el) {\r\n  // 将el挂载到vm上\r\n  vm.$el = el;\r\n\r\n  // 更新函数 数据变化后 会再次调用此函数\r\n  const updateComponent = () => {\r\n    // 调用render函数，生成虚拟dom\r\n    vm._update(vm._render()); // 后续更新可以调用updateComponent方法\r\n\r\n  };\r\n\r\n  // updateComponent();\r\n  callHook(vm, 'beforeMount')\r\n  new Watcher(vm, updateComponent, () => {\r\n    console.log('更新');\r\n  }, true);// true 表示为渲染watcher\r\n\r\n  callHook(vm, 'mounted')\r\n}\r\n\r\nexport function callHook(vm, hook) {\r\n  let handlers = vm.$options[hook];\r\n  if (handlers) {\r\n    for (let i = 0; i < handlers.length; i++) {\r\n      handlers[i].call(vm)\r\n    }\r\n  }\r\n}","const defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g; // {{aaaaa}}\r\n\r\n// html字符串 =》 字符串  _c('div',{id:'app',a:1},'hello')\r\n\r\nfunction genProps(attrs) {\r\n  // [{name:'xxx',value:'xxx'},{name:'xxx',value:'xxx'}]\r\n  let str = \"\";\r\n  for (let i = 0; i < attrs.length; i++) {\r\n    let attr = attrs[i];\r\n    if (attr.name === \"style\") {\r\n      // color:red;background:blue\r\n      let styleObj = {};\r\n      attr.value.replace(/([^;:]+)\\:([^;:]+)/g, function () {\r\n        styleObj[arguments[1]] = arguments[2];\r\n      });\r\n      attr.value = styleObj;\r\n    }\r\n    str += `${attr.name}:${JSON.stringify(attr.value)},`;\r\n  }\r\n  return `{${str.slice(0, -1)}}`;\r\n}\r\n\r\nfunction gen(el) {\r\n  if (el.type == 1) {\r\n    // element = 1 text = 3\r\n    return generate(el);\r\n  } else {\r\n    let text = el.text;\r\n    if (!defaultTagRE.test(text)) {\r\n      return `_v('${text}')`;\r\n    } else {\r\n      // 'hello' + arr + 'world'    hello {{arr}} {{aa}} world\r\n      let tokens = [];\r\n      let match;\r\n      let lastIndex = (defaultTagRE.lastIndex = 0); // CSS-LOADER 原理一样\r\n      while ((match = defaultTagRE.exec(text))) {\r\n        // 看有没有匹配到\r\n        let index = match.index; // 开始索引\r\n        if (index > lastIndex) {\r\n          tokens.push(JSON.stringify(text.slice(lastIndex, index)));\r\n        }\r\n        tokens.push(`_s(${match[1].trim()})`); // JSON.stringify()\r\n        lastIndex = index + match[0].length;\r\n      }\r\n      if (lastIndex < text.length) {\r\n        tokens.push(JSON.stringify(text.slice(lastIndex)));\r\n      }\r\n      return `_v(${tokens.join(\"+\")})`;\r\n    }\r\n  }\r\n}\r\n\r\nfunction genChildren(el) {\r\n  let children = el.children; // 获取儿子\r\n  if (children) {\r\n    return children.map((c) => gen(c)).join(\",\");\r\n  }\r\n  return false;\r\n}\r\n\r\nexport function generate(el) {\r\n  //  _c('div',{id:'app',a:1},_c('span',{},'world'),_v())\r\n  // 遍历树 将树拼接成字符串\r\n  let children = genChildren(el);\r\n  let code = `_c('${el.tag}',${el.attrs.length ? genProps(el.attrs) : \"undefined\"\r\n    }${children ? `,${children}` : \"\"})`;\r\n\r\n  return code;\r\n}\r\n","/*!\r\n * HTML Parser By John Resig (ejohn.org)\r\n * Modified by Juriy \"kangax\" Zaytsev\r\n * Original code by Erik Arvidsson (MPL-1.1 OR Apache-2.0 OR GPL-2.0-or-later)\r\n * http://erik.eae.net/simplehtmlparser/simplehtmlparser.js\r\n */\r\n\r\n\r\nconst ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`; // 标签名 \r\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`; //  用来获取的标签名的 match后的索引为1的\r\nconst startTagOpen = new RegExp(`^<${qnameCapture}`); // 匹配开始标签的 \r\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`); // 匹配闭合标签的\r\n//           aa  =   \"  xxx \"  | '  xxxx '  | xxx\r\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/; // a=b  a=\"b\"  a='b'\r\nconst startTagClose = /^\\s*(\\/?)>/; //     />   <div/>\r\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g; // {{aaaaa}}\r\n\r\n\r\n// ast (语法层面的描述 js css html) vdom （dom节点）\r\n\r\n// html字符串解析成 对应的脚本来触发 tokens  <div id=\"app\"> {{name}}</div>\r\n// 将解析后的结果 组装成一个树结构  栈\r\nfunction createAstElement(tagName, attrs) {\r\n  return {\r\n    tag: tagName,\r\n    type: 1,\r\n    children: [],\r\n    parent: null,\r\n    attrs\r\n  }\r\n}\r\nlet root = null;\r\nlet stack = [];\r\nfunction start(tagName, attributes) {\r\n  let parent = stack[stack.length - 1];\r\n  let element = createAstElement(tagName, attributes);\r\n  if (!root) {\r\n    root = element;\r\n  }\r\n  if (parent) {\r\n    element.parent = parent;// 当放入栈中时 继续父亲是谁\r\n    parent.children.push(element)\r\n  }\r\n  stack.push(element);\r\n}\r\nfunction end(tagName) {\r\n  let last = stack.pop();\r\n  if (last.tag !== tagName) {\r\n    throw new Error('标签有误');\r\n  }\r\n}\r\nfunction chars(text) {\r\n  text = text.replace(/\\s/g, \"\");\r\n  let parent = stack[stack.length - 1];\r\n  if (text) {\r\n    parent.children.push({\r\n      type: 3,\r\n      text\r\n    })\r\n  }\r\n}\r\n\r\nexport function parserHTML(html) {\r\n  function advance(len) {\r\n    html = html.substring(len);\r\n  }\r\n\r\n  function parseStartTag() {\r\n    const start = html.match(startTagOpen);\r\n    if (start) {\r\n      const match = {\r\n        tagName: start[1],\r\n        attrs: []\r\n      }\r\n      advance(start[0].length);\r\n      let end;\r\n      // 如果没有遇到标签结尾就不停的解析\r\n      let attr;\r\n\r\n      while (!(end = html.match(startTagClose)) && (attr = html.match(attribute))) {\r\n        match.attrs.push({ name: attr[1], value: attr[3] || attr[4] || attr[5] })\r\n        advance(attr[0].length)\r\n      }\r\n      if (end) {\r\n        advance(end[0].length);\r\n      }\r\n      return match;\r\n    }\r\n    return false; // 不是开始标签\r\n  }\r\n  while (html) { // 看要解析的内容是否存在，如果存在就不停的解析\r\n    let textEnd = html.indexOf('<'); // 当前解析的开头  \r\n    if (textEnd == 0) {\r\n      const startTagMatch = parseStartTag(html); // 解析开始标签\r\n      if (startTagMatch) {\r\n        start(startTagMatch.tagName, startTagMatch.attrs)\r\n        continue;\r\n      }\r\n      const endTagMatch = html.match(endTag);\r\n      if (endTagMatch) {\r\n        end(endTagMatch[1]);\r\n        advance(endTagMatch[0].length);\r\n        continue;\r\n      }\r\n    }\r\n    let text; // //  </div>\r\n    if (textEnd > 0) {\r\n      text = html.substring(0, textEnd)\r\n    }\r\n    if (text) {\r\n      chars(text);\r\n      advance(text.length);\r\n    }\r\n  }\r\n\r\n  return root;\r\n}\r\n\r\n\r\n// 看一下用户是否传入了 , 没传入可能传入的是 template, template如果也没有传递\r\n// 将我们的html =》 词法解析  （开始标签 ， 结束标签，属性，文本）\r\n// => ast语法树 用来描述html语法的 stack=[]\r\n\r\n// codegen  <div>hello</div>  =>   _c('div',{},'hello')  => 让字符串执行\r\n// 字符串如果转成代码 eval 好性能 会有作用域问题\r\n\r\n// 模板引擎 new Function + with 来实现","import { generate } from \"./generate\";\r\nimport { parserHTML } from \"./parser\";\r\n\r\nexport function compileToFunction(template) {\r\n  let root = parserHTML(template);\r\n\r\n  // 生成代码\r\n  let code = generate(root);\r\n  // code 中会用到数据 数据在vm上\r\n  const render = new Function(`w$ith(this){return {code}}`);\r\n\r\n  return render;\r\n}\r\n","import { isObject } from \"./index\";\r\n\r\nconst lifeCycleHooks = [\r\n  \"beforeCreate\",\r\n  \"created\",\r\n  \"beforeMount\",\r\n  \"mounted\",\r\n  \"beforeUpdate\",\r\n  \"updated\",\r\n  \"beforeDestroy\",\r\n  \"destroyed\",\r\n];\r\n\r\nlet strats = {}; // 存放各种策略\r\n\r\nfunction mergeHook(parentVal, childVal) {\r\n  if (childVal) {\r\n    if (parentVal) {\r\n      return parentVal.concat(childVal); // 后续\r\n    } else {\r\n      return [childVal]; // 第一次\r\n    }\r\n  } else {\r\n    return parentVal;\r\n  }\r\n}\r\n\r\nlifeCycleHooks.forEach((hook) => {\r\n  strats[hook] = mergeHook;\r\n});\r\n\r\nexport function mergeOptions(parent, child) {\r\n  const options = {}; // 合并后的结果\r\n  for (let key in parent) {\r\n    mergeField(key);\r\n  }\r\n  for (let key in child) {\r\n    if (parent.hasOwnProperty(key)) {\r\n      continue;\r\n    }\r\n    mergeField(key);\r\n  }\r\n\r\n  function mergeField(key) {\r\n    const parentVal = parent[key];\r\n    const childVal = child[key];\r\n    // 策略模式\r\n    if (strats[key]) {\r\n      // 如果有对应的策略就调用对应的策略即可\r\n      options[key] = strats[key](parentVal, childVal);\r\n    } else {\r\n      if (isObject(parentVal) && isObject(childVal)) {\r\n        options[key] = { ...parentVal, ...childVal };\r\n      } else {\r\n        // 父亲中有，儿子中没有\r\n        options[key] = child[key] || parent[key];\r\n      }\r\n    }\r\n  }\r\n  return options;\r\n}\r\n","import { initState } from \"./state\";\r\nimport { callHook, mountComponent } from \"./lifecycle\";\r\nimport { compileToFunction } from \"../compiler/index\";\r\nimport { mergeOptions } from \"../util/options\";\r\n\r\nexport function initMixin(Vue) {\r\n  Vue.prototype._init = function (options) {\r\n    const vm = this;\r\n    // $options\r\n    vm.$options = mergeOptions(vm.constructor.options, options);\r\n\r\n    callHook(vm, \"beforeCreate\");\r\n\r\n    // 初始化状态\r\n    initState(vm);\r\n\r\n    callHook(vm, \"created\");\r\n\r\n    if (vm.$options.el) {\r\n      // 将数据挂载到这个模板上\r\n      vm.$mount(vm.$options.el);\r\n    }\r\n  };\r\n\r\n  Vue.prototype.$mount = function (el) {\r\n    const vm = this;\r\n    const options = vm.$options;\r\n    el = document.querySelector(el);\r\n\r\n    // 如果没有render方法\r\n    if (!options.render) {\r\n      let template = options.template;\r\n      // 如果没有模板但是有el\r\n      if (!template && el) {\r\n        template = el.outerHTML;\r\n      }\r\n      const render = compileToFunction(template); //将template编译成render函数\r\n\r\n      options.render = render;\r\n    }\r\n\r\n    mountComponent(vm, el); // 组件的挂载流程\r\n  };\r\n}\r\n","export function createElement(vm, tag, data = {}, ...children) {\r\n  return vnode(vm, tag, data, data.key, children, undefined);\r\n}\r\n\r\nexport function createTextElement(vm, text) {\r\n  return vnode(vm, undefined, undefined, undefined, undefined, text);\r\n}\r\n\r\nfunction vnode(vm, tag, data, key, children, text) {\r\n  return {\r\n    vm,\r\n    tag,\r\n    data,\r\n    key,\r\n    children,\r\n    text,\r\n    // .....\r\n  }\r\n}","import { createElement, createTextElement } from \"../vdom/index\";\r\n\r\nexport function renderMixin(Vue) {\r\n  Vue.prototype._c = function () {\r\n    // createElement\r\n    return createElement(this, ...arguments);\r\n  };\r\n  Vue.prototype._v = function (text) {\r\n    // createTextElement\r\n    return createTextElement(this, text);\r\n  };\r\n  Vue.prototype._s = function (val) {\r\n    // stringify\r\n    if (typeof val == \"object\") return JSON.stringify(val);\r\n    return val;\r\n  };\r\n\r\n  Vue.prototype._render = function () {\r\n    const vm = this;\r\n    let render = vm.$options.render; // 就是我们解析出来的render方法，同时也有可能是用户写的\r\n    let vnode = render.call(vm);\r\n    return vnode;\r\n  };\r\n}\r\n","import { mergeOptions } from \"../util/options\";\n\nexport function initGlobalApi(Vue) {\n  Vue.options = {}; // 用来存放全局的配置 , 每个组件初始化的时候都会和options选项进行合并\n  // Vue.component\n  // Vue.filter\n  // Vue.directive\n\n  Vue.mixin = function (options) {\n    this.options = mergeOptions(this.options, options);\n    return this;\n  }\n\n}","import { initMixin } from \"./init\";\r\nimport { lifecycleMixin } from \"./lifecycle\";\r\nimport { renderMixin } from \"./render\";\r\nimport { stateMixin } from \"./state\";\r\nimport { initGlobalApi } from \"../global-api/index\";\r\n\r\nfunction Vue(options) {\r\n  // options 为用户传入的参数\r\n  this._init(options); //初始化\r\n}\r\n\r\n// 扩展原型方法\r\n\r\ninitMixin(Vue); //给原型加 init方法\r\n\r\nstateMixin(Vue); // 给原型加 $watch 方法\r\n\r\nlifecycleMixin(Vue); //_update方法 转为 真实dom\r\n\r\nrenderMixin(Vue); //_render方法 生成vdom\r\n\r\n// 在类上扩展的 Vue.mixin\r\ninitGlobalApi(Vue);\r\n\r\nexport default Vue;\r\n\r\n/**\r\n * init 主要做了状态的初始化（数据的初始化）\r\n * $mount 找render方法(tempelete => render   ast->codegen->字符串)\r\n * render = with + new Function(code) 产生虚拟dom的方法\r\n * 虚拟dom => 真实dom\r\n * vm._update(vm_render())   虚拟dom->真实dom\r\n */"],"names":["arrayProto","Array","prototype","arrayMethods","Object","create","methodsToPatch","forEach","method","args","result","apply","ob","__ob__","inserted","slice","observeArray","dep","notify","isObject","val","id","Dep","subs","target","addDep","sub","update","push","stack","pushTarget","watcher","popTarget","pop","length","Observer","value","defineProperty","enumerable","isArray","__proto__","walk","obj","keys","i","defineReactive","data","observe","key","childOb","configurable","get","reactiveGetter","depend","dependArray","set","reactiveSetter","newVal","current","callbacks","flushCallbacks","cb","waiting","timer","timerFn","Promise","resolve","then","MutationObserver","textNode","document","createTextNode","characterData","textContent","setImmediate","setTimeout","nextTick","queue","has","flushSchedulerQueue","run","pending","queueWatcher","Watcher","vm","expOrFn","options","deps","depIds","Set","user","lazy","dirty","getter","path","split","undefined","call","add","addSub","oldVal","stateMixin","Vue","$watch","handler","initState","opts","$options","initData","watch","initWatch","props","initProps","methods","initMethods","computed","initComputed","_data","getData","proxy","sourceKey","createWatcher","watchers","_computedWatchers","userDef","defineComputed","sharedProperty","createComputedGetter","evaluate","patch","oldVnode","vnode","nodeType","parentElm","parentNode","elm","createElm","insertBefore","nextSibling","removeChild","tag","children","text","el","createElement","child","appendChild","lifecycleMixin","_update","$el","mountComponent","updateComponent","_render","callHook","console","log","hook","handlers","defaultTagRE","genProps","attrs","str","attr","name","styleObj","replace","arguments","JSON","stringify","gen","type","generate","test","tokens","match","lastIndex","exec","index","trim","join","genChildren","map","c","code","ncname","qnameCapture","startTagOpen","RegExp","endTag","attribute","startTagClose","createAstElement","tagName","parent","root","start","attributes","element","end","last","Error","chars","parserHTML","html","advance","len","substring","parseStartTag","textEnd","indexOf","startTagMatch","endTagMatch","compileToFunction","template","render","Function","lifeCycleHooks","strats","mergeHook","parentVal","childVal","concat","mergeOptions","mergeField","hasOwnProperty","initMixin","_init","constructor","$mount","querySelector","outerHTML","createTextElement","renderMixin","_c","_v","_s","initGlobalApi","mixin"],"mappings":"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"}